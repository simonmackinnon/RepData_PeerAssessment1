---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
```{r}
unzip("activity.zip")
stepsData <- read.csv("activity.csv", header = TRUE)
#filter out the invalid values in "steps" variable
stepsData <- stepsData[!is.na(stepsData$steps),]
```

## What is mean total number of steps taken per day?

We can find the total steps per day as a daily aggregate of the total number of steps. Using this, we can then find the mean and median total number of steps taken per day.

```{r fig.align='center', fig.width=7, fig.height=5}
stepsDailyAggregate <- aggregate(x = stepsData$steps, 
                                 by = list(stepsData$date),  
                                 FUN = function(x){sum(as.numeric(x))})
hist(stepsDailyAggregate$x, 
     n = 15,
     main = "Histogram of Total Daily Steps",
     xlab = "Total Daily Steps")

abline(v = mean(stepsDailyAggregate$x),
       lty = "solid",
       lwd = 2,
       col = "blue")

abline(v = median(stepsDailyAggregate$x), 
       lty = "dashed",
       lwd = 2,
       col = "red")

#turn off clipping, as legends with long text tend to get clipped
par(xpd=TRUE)

legend("topright", 
     lty=c("solid","dashed"),
     lwd=c(2,2),
     col = c("blue", "red"),
     bty = "n",
     legend = c(paste("Mean total daily steps =",
                      round(mean(stepsDailyAggregate$x), digits=2),
                      "\n"), 
                paste("Median total daily steps",
                      round(median(stepsDailyAggregate$x), digits = 2),
                      "\n")),
     cex=0.60, pt.cex = 1)

#turn clipping on again
par(xpd=FALSE)
```

The mean total number of steps taken per day is **`r options(scipen=999)``r round(mean(stepsDailyAggregate$x),digits=2)`** steps.


## What is the average daily activity pattern?
```{r fig.align='center', fig.width=7, fig.height=5}
#Get the interval aggregated average number of steps
stepsIntervalAggregate <- aggregate(x = stepsData$steps, 
                                 by = list(stepsData$interval),  
                                 FUN = function(x){mean(as.numeric(x))})

#convert the intervals into a time series
minute_times <- strptime (sprintf("%04d", stepsIntervalAggregate$Group.1),
                          format = "%H%M")

#Add the time series to the aggregated data
stepsIntervalAggregate <- cbind(stepsIntervalAggregate, minute_times)

plot(stepsIntervalAggregate$minute_times, 
     stepsIntervalAggregate$x,
     main = "Average Daily Activity Pattern",
     xlab = "Time",
     ylab = "Average no. of steps per time interval",
     col = "blue",
     lwd = c(2),
     type = "l")

#turn off clipping, as legends with long text tend to get clipped
par(xpd=TRUE)

legend("topright", 
     lty=c("solid"),
     lwd=c(2),
     col = c("blue"),
     bty = "n",
     legend = c(paste("Average no.    \nof steps per    \ninterval    ",                    
                      "\n")),
     cex=0.60, pt.cex = 1)

#turn clipping on again
par(xpd=FALSE)

```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
